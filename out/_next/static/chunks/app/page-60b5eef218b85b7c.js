(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6545:function(e,t,s){Promise.resolve().then(s.bind(s,6491))},6491:function(e,t,s){"use strict";let a;s.r(t),s.d(t,{default:function(){return T}});var r,n,l=s(9268),i=s(6006),c=s(6008),o=s(184),d=s(6267);let u=/^(.+)\/(.+)$/,h=/^(.+)\s+\((.+)\)$/,m=/((identify|name|give) (both|all)|(what (two|three) ))/;function x(e,t){let s=t.trim(),a=function(e,t){let s=new o.Z([e],{includeScore:!0,location:e.length-t.length,distance:1.2*e.length,threshold:2}),a=s.search(t);return a.length>0&&void 0!==a[0].score&&a[0].score<=.4}(e,s),r=function(e,t){let s=Math.max(1,e.length);return(0,d.T)(e,t)/s<=.25}(e,s);return a||r}function g(e){let t=h[Symbol.match](e);return null===t?[e]:[t[1],t[2]]}class f{markAnswerAsCorrect(e){let t=this.getStatisticsForQuestion(e);return t.correct+=1,t.total+=1,this.setStatisticsForQuestion(e,t),t}markAnswerAsIncorrect(e){let t=this.getStatisticsForQuestion(e);return t.total+=1,this.setStatisticsForQuestion(e,t),t}getStatisticsForQuestion(e){var t;return null!==(t=this.database.get(this.serializeQuestionId(e)))&&void 0!==t?t:{correct:0,total:0}}size(){return this.database.size}isEligibleForPractice(){return this.getPracticeQuestions().length>20}getPracticeQuestions(){return Array.from(this.database.entries()).filter(e=>{let[t,s]=e;return 0!==s.total&&s.correct/s.total<=.5}).map(e=>{let[t,s]=e;return this.deserializeQuestionId(t)})}reset(){this.database=new Map,this.serializeToStorage()}setStatisticsForQuestion(e,t){this.database.set(this.serializeQuestionId(e),t),this.serializeToStorage()}serializeQuestionId(e){return"".concat(e.league,"-").concat(e.day,"-").concat(e.index)}deserializeQuestionId(e){let t=e.split("-");return{league:parseInt(t[0],10),day:parseInt(t[1],10),index:parseInt(t[2],10)}}serializeToStorage(){let e=JSON.stringify(Object.fromEntries(this.database));this.storage.setItem(f.LOCAL_STORAGE_KEY,e)}deserializeFromStorage(){let e=this.storage.getItem(f.LOCAL_STORAGE_KEY);return null===e?new Map:new Map(Object.entries(JSON.parse(e)))}constructor(e){void 0!==e?this.storage=e:this.storage={getItem:e=>null,setItem(e,t){},key:e=>null,clear(){},length:0,removeItem(e){}},this.database=this.deserializeFromStorage()}}f.LOCAL_STORAGE_KEY="answer-history";var p=s(9738),y=s(4398),j=s(5807);function b(e){let{onConfirm:t,onCancel:s,isOpen:a}=e,r=(0,i.useRef)(null);return(0,l.jsx)(p.u.Root,{show:a,as:i.Fragment,children:(0,l.jsxs)(y.V,{as:"div",className:"relative z-10",initialFocus:r,onClose:s,children:[(0,l.jsx)(p.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})}),(0,l.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,l.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,l.jsx)(p.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,l.jsxs)(y.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:[(0,l.jsx)("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:(0,l.jsxs)("div",{className:"sm:flex sm:items-start",children:[(0,l.jsx)("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:(0,l.jsx)(j.Z,{className:"h-6 w-6 text-red-600","aria-hidden":"true"})}),(0,l.jsxs)("div",{className:"mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left",children:[(0,l.jsx)(y.V.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900",children:"Reset answer history?"}),(0,l.jsx)("div",{className:"mt-2",children:(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"Are you sure you want to reset your answer history? All of your data will be permanently removed. This action cannot be undone."})})]})]})}),(0,l.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[(0,l.jsx)("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto",onClick:()=>{t()},children:"Reset History"}),(0,l.jsx)("button",{type:"button",className:"mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto",onClick:()=>{s()},ref:r,children:"Cancel"})]})]})})})})]})})}function w(e,t){return Math.floor(Math.random()*(t-e+1)+e)}(r=n||(n={}))[r.REGULAR=0]="REGULAR",r[r.PRACTICE=1]="PRACTICE";let[v,N]=[60,96],[S,C]=[1,25],[E,A]=[0,5],k={correct:0,total:0},R={},I=()=>{let[e,t]=(0,i.useState)(!1),[s,r]=(0,i.useState)((0,c.useSearchParams)()),[o,d]=(0,i.useState)(new f(localStorage)),[h,p]=(0,i.useState)({league:0,day:0,index:0}),[y,j]=(0,i.useState)(n.REGULAR),[I,T]=(0,i.useState)(""),[F,_]=(0,i.useState)(""),[L,z]=(0,i.useState)(""),[O,P]=(0,i.useState)(""),[Q,M]=(0,i.useState)(""),[G,D]=(0,i.useState)(" "),[U,W]=(0,i.useState)(" "),[q,K]=(0,i.useState)(" "),[V,Y]=(0,i.useState)(" "),[H,J]=(0,i.useState)(" "),[Z,$]=(0,i.useState)(""),[B,X]=(0,i.useState)(!0),[ee,et]=(0,i.useState)(!1),[es,ea]=(0,i.useState)(!0),er=(0,i.useRef)(null);function en(e){return null===e?null:parseInt(e,10)}let el=async()=>{try{console.log("GameMode[gameMode] in fetchData"),console.log(n[y]);let e=y===n.PRACTICE?function(){let e=o.getPracticeQuestions(),t=w(0,e.length);return console.log(e),e[t]}():function(){let e={league:w(v,N),day:w(S,C),index:w(E,A)},t=en(s.get("league"));null!==t&&t>=v&&t<=N&&(e.league=t);let a=en(s.get("day"));null!==a&&a>=S&&a<=C&&(e.day=a);let r=en(s.get("index"));return null!==r&&r>=E&&r<=A&&(e.index=r),e}();p(e),console.log("fetching league ".concat(e.league," on day ").concat(e.day," for mode ").concat(n[y]));let t=await fetch("data/league".concat(e.league,"_day").concat(e.day,".json")),r=await t.json(),l=r.questions[e.index];if(a=l,T(l.prompt),_(l.category),z(r.date),null!=l.image){let e="https://learnedleague.com"+String(a.image);M(e)}else M("")}catch(e){console.error("Error fetching data:",e)}},ei=e=>{"n"===e.key&&es&&(ec(),e.preventDefault())};(0,i.useEffect)(()=>(document.addEventListener("keydown",ei),()=>{document.removeEventListener("keydown",ei)}),[es,y]),(0,i.useEffect)(()=>{t(!0),ec()},[]),(0,i.useEffect)(()=>{!es&&er.current&&er.current.focus()},[es]),(0,i.useEffect)(()=>{console.log("game mode changed"),el()},[y]);let ec=()=>{if(console.log("handling next"),console.log(es),es)el(),P(""),$(""),D(""),W(""),K(""),Y(""),J("");else{let e=function(e,t,s){var a;let r;let n=s.trim();if(x(t,n))return!0;let l=(a=t.toLowerCase(),null===(r=u[Symbol.match](a))?[a]:[r[1],r[2]]).flatMap(e=>e.split(", ")).flatMap(g),i=n.split(","),c=l.map(e=>i.map(t=>x(e,t)).includes(!0)).filter(e=>e),o=m.test(e);return c.length>(o?1:0)}(a.prompt,a.answer,Z);void 0===R[a.category]&&(R[a.category]={correct:0,total:0}),e?(k.correct+=1,R[a.category].correct+=1,X(!0),o.markAnswerAsCorrect(h)):(X(!1),o.markAnswerAsIncorrect(h)),P(a.answer),D(a.a_percent),W(a.b_percent),K(a.c_percent),Y(a.d_percent),J(a.e_percent),k.total+=1,R[a.category].total+=1}console.log("setting is showing answer :".concat(!es)),ea(!es)},eo=()=>{o.reset()},ed=e=>{if(!es){let t=e.target.value;$(t)}},eu=e=>{es||"Enter"!==e.key||""==Z||ec()},eh=e=>{let t="".concat(e.correct,"/").concat(e.total),s=0===e.total?1:e.total,a=e.correct/s*100;return(0,l.jsxs)("span",{children:[t," (",a.toFixed(2),"%)"]})},em=""!==Q&&(Q.endsWith(".jpg")||Q.endsWith(".png")),ex=""!==Q&&!(Q.endsWith(".jpg")||Q.endsWith(".png")),eg=o.isEligibleForPractice();return e?(0,l.jsxs)("div",{className:"container mx-auto",children:[(0,l.jsx)(b,{isOpen:ee,onConfirm:()=>{eo(),et(!1)},onCancel:()=>et(!1)}),(0,l.jsxs)("div",{className:"flex flex-row items-start gap-4 flex-wrap md:flex-nowrap",children:[(0,l.jsx)("div",{className:"container basis-full shrink-0 md:basis-2/3",children:(0,l.jsx)("div",{className:"card bg-base-100 shadow",children:(0,l.jsxs)("div",{className:"card-body",children:[(0,l.jsxs)("div",{className:"flex flex-row justify-between flex-wrap",children:[(0,l.jsxs)("h3",{className:"card-title",children:[F," - ",L]}),(0,l.jsxs)("h3",{className:"card-title",children:["League ",h.league," - Day ",h.day]})]}),(0,l.jsx)("p",{children:I}),em?(0,l.jsx)("figure",{className:"px-10 pt-10",children:(0,l.jsx)("img",{src:Q,alt:Q})}):"",ex?(0,l.jsx)("a",{className:"link",href:Q,target:"_blank",hidden:""==Q,children:"Click here"}):"",(0,l.jsxs)("h2",{className:"font-bold mt-2"+(es?"":" hidden"),children:["ANSWER - ",O]}),(0,l.jsxs)("div",{className:"flex flex-row gap-4 mt-6",children:[(0,l.jsx)("input",{type:"text",placeholder:"Type the answer",className:"input input-bordered w-full"+(es?B?" input-success":" input-error":""),value:Z,onChange:ed,onKeyDown:eu,ref:er,readOnly:es}),(0,l.jsx)("div",{className:"tooltip tooltip-primary hidden md:block","data-tip":es?"Shortcut: N":"Shortcut: Enter",children:(0,l.jsx)("button",{className:"btn btn-primary",onClick:ec,disabled:""==Z,children:es?"Next":"Check"})}),(0,l.jsx)("button",{className:"btn btn-primary block md:hidden",onClick:ec,disabled:""==Z,children:es?"Next":"Check"})]})]})})}),(0,l.jsx)("div",{className:"card bg-base-100 shadow basis-full shrink md:basis-1/3",children:(0,l.jsxs)("div",{className:"card-body",children:[(0,l.jsxs)("h3",{className:"card-title",children:["Game Mode: ",n[y]]}),(0,l.jsxs)("h3",{className:"card-title",children:["Total score: ",eh(k)]}),(0,l.jsx)("h3",{className:"card-title",children:"Correct % per level"}),(0,l.jsxs)("table",{className:"table table-compact text-center",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{style:{zIndex:10},children:"A"}),(0,l.jsx)("th",{children:"B"}),(0,l.jsx)("th",{children:"C"}),(0,l.jsx)("th",{children:"D"}),(0,l.jsx)("th",{children:"E"})]})}),(0,l.jsx)("tbody",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:G}),(0,l.jsx)("td",{children:U}),(0,l.jsx)("td",{children:q}),(0,l.jsx)("td",{children:V}),(0,l.jsx)("td",{children:H})]})})]}),(0,l.jsxs)("table",{className:"table table-compact text-center",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{style:{zIndex:10},children:"Category"}),(0,l.jsx)("th",{children:"Score"})]})}),(0,l.jsx)("tbody",{children:Object.entries(R).map(e=>{let[t,s]=e;return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:t}),(0,l.jsx)("td",{children:eh(s)})]},t)})})]}),(0,l.jsx)("h3",{className:"card-title mt-6",children:"Settings"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("button",{type:"button",style:{cursor:eg?"pointer":"not-allowed"},className:"inline-flex w-full rounded-md px-3 py-2 text-sm font-semibold text-white shadow-sm sm:ml-3 sm:w-auto ".concat(eg?"bg-green-600 hover:bg-green-500":"bg-gray-300 hover:bg-gray-300"),onClick:()=>{eg&&(console.log("setting game mode"),j(y===n.REGULAR?n.PRACTICE:n.REGULAR))},children:y===n.REGULAR?"Enter Practice Mode":"Enter Regular Mode"}),eg?null:(0,l.jsxs)("div",{className:"mt-2 mb-2",children:["Practice mode is available when you have more than 20 questions answered with less than 50% accuracy (current: ",o.getPracticeQuestions().length,")"]})]}),(0,l.jsx)("div",{children:(0,l.jsx)("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-red-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-500 sm:ml-3 sm:w-auto",onClick:()=>et(!0),children:"Reset Answer History"})}),(0,l.jsx)("p",{children:"TODO: Add more features"}),(0,l.jsx)("h3",{className:"card-title mt-6",children:"Lifetime Stats"}),(0,l.jsxs)("div",{className:"flex flex-row gap-4",children:["Lifetime unique questions answered: ",o.size()]})]})})]})]}):null};var T=I}},function(e){e.O(0,[842,667,139,744],function(){return e(e.s=6545)}),_N_E=e.O()}]);